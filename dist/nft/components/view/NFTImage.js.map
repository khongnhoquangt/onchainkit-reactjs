{"version":3,"file":"NFTImage.js","sources":["../../../../src/nft/components/view/NFTImage.tsx"],"sourcesContent":["import type { NFTError } from '@/api/types';\nimport { useNFTContext } from '@/nft/components/NFTProvider';\nimport { type MouseEvent, useCallback, useEffect, useState } from 'react';\nimport { defaultNFTSvg } from '../../../internal/svg/defaultNFTSvg';\nimport { cn } from '../../../styles/theme';\n\ntype NFTImageReact = {\n  className?: string;\n  square?: boolean;\n  onLoading?: (mediaUrl: string) => void;\n  onLoaded?: () => void;\n  onError?: (error: NFTError) => void;\n};\n\nexport function NFTImage({\n  className,\n  square = true,\n  onLoading,\n  onLoaded,\n  onError,\n}: NFTImageReact) {\n  const { imageUrl, description } = useNFTContext();\n  const [loaded, setLoaded] = useState(false);\n  const [error, setError] = useState(false);\n\n  const loadImage = useCallback(() => {\n    if (imageUrl) {\n      onLoading?.(imageUrl);\n\n      const img = new Image();\n      img.onload = () => {\n        setLoaded(true);\n        onLoaded?.();\n      };\n\n      img.onerror = (error: string | Event) => {\n        onError?.({\n          error: typeof error === 'string' ? error : error.type,\n          code: 'NmNIc01', // NFT module NFTImage component 01 error\n          message: 'Error loading image',\n        });\n        setError(true);\n      };\n      img.src = imageUrl;\n    }\n  }, [imageUrl, onLoading, onLoaded, onError]);\n\n  useEffect(() => {\n    loadImage();\n  }, [loadImage]);\n\n  const handleRetry = useCallback(\n    async (e: MouseEvent) => {\n      e.stopPropagation();\n      setError(false);\n      loadImage();\n    },\n    [loadImage],\n  );\n\n  return (\n    <div\n      className={cn(\n        'grid w-full',\n        '[&>*]:col-start-1 [&>*]:col-end-1 [&>*]:row-start-1 [&>*]:row-end-1',\n        { 'aspect-square': square },\n        className,\n      )}\n    >\n      <div className=\"flex items-center justify-center\">{defaultNFTSvg}</div>\n      <div\n        className={cn(\n          'grid h-full w-full content-center justify-center overflow-hidden',\n          { 'aspect-square': square },\n        )}\n      >\n        <img\n          data-testid=\"ockNFTImage\"\n          src={imageUrl}\n          alt={description}\n          decoding=\"async\"\n          className={cn(\n            'transition-opacity duration-500 ease-in-out',\n            loaded ? 'opacity-100' : 'opacity-0',\n            { 'h-full w-full object-cover': square },\n          )}\n        />\n      </div>\n      {error && (\n        <div className=\"flex items-center justify-center\">\n          <button type=\"button\" onClick={handleRetry} className=\"z-10 mt-[60%]\">\n            retry\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["error"],"mappings":";;;;;AAcO,SAAS,SAAS;AAAA,EACvB;AAAA,EACA,SAAS;AAAA,EACT;AAAA,EACA;AAAA,EACA;AACF,GAAkB;AAChB,QAAM,EAAE,UAAU,YAAA,IAAgB,cAAA;AAClC,QAAM,CAAC,QAAQ,SAAS,IAAI,SAAS,KAAK;AAC1C,QAAM,CAAC,OAAO,QAAQ,IAAI,SAAS,KAAK;AAExC,QAAM,YAAY,YAAY,MAAM;AAClC,QAAI,UAAU;AACZ,6CAAY;AAEZ,YAAM,MAAM,IAAI,MAAA;AAChB,UAAI,SAAS,MAAM;AACjB,kBAAU,IAAI;AACd;AAAA,MACF;AAEA,UAAI,UAAU,CAACA,WAA0B;AACvC,2CAAU;AAAA,UACR,OAAO,OAAOA,WAAU,WAAWA,SAAQA,OAAM;AAAA,UACjD,MAAM;AAAA;AAAA,UACN,SAAS;AAAA,QAAA;AAEX,iBAAS,IAAI;AAAA,MACf;AACA,UAAI,MAAM;AAAA,IACZ;AAAA,EACF,GAAG,CAAC,UAAU,WAAW,UAAU,OAAO,CAAC;AAE3C,YAAU,MAAM;AACd,cAAA;AAAA,EACF,GAAG,CAAC,SAAS,CAAC;AAEd,QAAM,cAAc;AAAA,IAClB,OAAO,MAAkB;AACvB,QAAE,gBAAA;AACF,eAAS,KAAK;AACd,gBAAA;AAAA,IACF;AAAA,IACA,CAAC,SAAS;AAAA,EAAA;AAGZ,SACE;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAW;AAAA,QACT;AAAA,QACA;AAAA,QACA,EAAE,iBAAiB,OAAA;AAAA,QACnB;AAAA,MAAA;AAAA,MAGF,UAAA;AAAA,QAAA,uBAAC,OAAA,EAAI,WAAU,oCAAoC,UAAA,cAAA,GAAnD,QAAA,OAAA;AAAA,UAAA,UAAA;AAAA,UAAA,YAAA;AAAA,UAAA,cAAA;AAAA,QAAA,GAAA,IAAiE;AAAA,QACjE;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAW;AAAA,cACT;AAAA,cACA,EAAE,iBAAiB,OAAA;AAAA,YAAO;AAAA,YAG5B,UAAA;AAAA,cAAC;AAAA,cAAA;AAAA,gBACC,eAAY;AAAA,gBACZ,KAAK;AAAA,gBACL,KAAK;AAAA,gBACL,UAAS;AAAA,gBACT,WAAW;AAAA,kBACT;AAAA,kBACA,SAAS,gBAAgB;AAAA,kBACzB,EAAE,8BAA8B,OAAA;AAAA,gBAAO;AAAA,cACzC;AAAA,cATF;AAAA,cAAA;AAAA,cAAA;AAAA,gBAAA,UAAA;AAAA,gBAAA,YAAA;AAAA,gBAAA,cAAA;AAAA,cAAA;AAAA,cAAA;AAAA,YAAA;AAAA,UAUA;AAAA,UAhBF;AAAA,UAAA;AAAA,UAAA;AAAA,YAAA,UAAA;AAAA,YAAA,YAAA;AAAA,YAAA,cAAA;AAAA,UAAA;AAAA,UAAA;AAAA,QAAA;AAAA,QAkBC,SACC,uBAAC,OAAA,EAAI,WAAU,oCACb,UAAA,uBAAC,UAAA,EAAO,MAAK,UAAS,SAAS,aAAa,WAAU,iBAAgB,UAAA,QAAA,GAAtE,QAAA,OAAA;AAAA,UAAA,UAAA;AAAA,UAAA,YAAA;AAAA,UAAA,cAAA;AAAA,QAAA,GAAA,IAEA,EAAA,GAHF,QAAA,OAAA;AAAA,UAAA,UAAA;AAAA,UAAA,YAAA;AAAA,UAAA,cAAA;AAAA,QAAA,GAAA,IAIA;AAAA,MAAA;AAAA,IAAA;AAAA,IAhCJ;AAAA,IAAA;AAAA,IAAA;AAAA,MAAA,UAAA;AAAA,MAAA,YAAA;AAAA,MAAA,cAAA;AAAA,IAAA;AAAA,IAAA;AAAA,EAAA;AAoCJ;"}