{"version":3,"file":"NFTMedia.js","sources":["../../../../src/nft/components/view/NFTMedia.tsx"],"sourcesContent":["import type { NFTError } from '@/api/types';\nimport { useNFTLifecycleContext } from '@/nft/components/NFTLifecycleProvider';\nimport { useNFTContext } from '@/nft/components/NFTProvider';\nimport { LifecycleType, MediaType } from '@/nft/types';\nimport { useCallback, useMemo } from 'react';\nimport { cn } from '../../../styles/theme';\nimport { NFTAudio } from './NFTAudio';\nimport { NFTImage } from './NFTImage';\nimport { NFTVideo } from './NFTVideo';\n\ntype NFTMediaReact = {\n  className?: string;\n  square?: boolean;\n};\n\nexport function NFTMedia({ className, square }: NFTMediaReact) {\n  const { mimeType } = useNFTContext();\n  const { type, updateLifecycleStatus } = useNFTLifecycleContext();\n\n  const mediaType = useMemo(() => {\n    if (mimeType?.startsWith('video')) {\n      return MediaType.Video;\n    }\n    if (mimeType?.startsWith('audio')) {\n      return MediaType.Audio;\n    }\n    if (mimeType?.startsWith('image')) {\n      return MediaType.Image;\n    }\n    return MediaType.Unknown;\n  }, [mimeType]);\n\n  const handleLoading = useCallback(\n    (mediaUrl: string) => {\n      updateLifecycleStatus({\n        statusName: 'mediaLoading',\n        statusData: {\n          mediaType,\n          mediaUrl,\n        },\n      });\n    },\n    [mediaType, updateLifecycleStatus],\n  );\n\n  const handleLoaded = useCallback(() => {\n    // for Views, this is the success state\n    updateLifecycleStatus({\n      statusName: type === LifecycleType.MINT ? 'mediaLoaded' : 'success',\n    });\n  }, [type, updateLifecycleStatus]);\n\n  const handleError = useCallback(\n    (error: NFTError) => {\n      updateLifecycleStatus({\n        statusName: 'error',\n        statusData: error,\n      });\n    },\n    [updateLifecycleStatus],\n  );\n\n  const media = useMemo(() => {\n    switch (mediaType) {\n      case MediaType.Video:\n        return (\n          <NFTVideo\n            square={square}\n            onLoading={handleLoading}\n            onLoaded={handleLoaded}\n            onError={handleError}\n          />\n        );\n      case MediaType.Audio:\n        return (\n          <div className=\"relative w-full\">\n            <NFTImage square={square} />\n            <div className=\"absolute bottom-4 mx-auto w-full\">\n              <NFTAudio />\n            </div>\n          </div>\n        );\n      default:\n        // fallback to image\n        return (\n          <NFTImage\n            square={square}\n            onLoading={handleLoading}\n            onLoaded={handleLoaded}\n            onError={handleError}\n          />\n        );\n    }\n  }, [handleError, handleLoaded, handleLoading, mediaType, square]);\n\n  return <div className={cn('pb-2', className)}>{media}</div>;\n}\n"],"names":[],"mappings":";;;;;;;;;AAeO,SAAS,SAAS,EAAE,WAAW,UAAyB;AAC7D,QAAM,EAAE,SAAA,IAAa,cAAA;AACrB,QAAM,EAAE,MAAM,sBAAA,IAA0B,uBAAA;AAExC,QAAM,YAAY,QAAQ,MAAM;AAC9B,QAAI,qCAAU,WAAW,UAAU;AACjC,aAAO,UAAU;AAAA,IACnB;AACA,QAAI,qCAAU,WAAW,UAAU;AACjC,aAAO,UAAU;AAAA,IACnB;AACA,QAAI,qCAAU,WAAW,UAAU;AACjC,aAAO,UAAU;AAAA,IACnB;AACA,WAAO,UAAU;AAAA,EACnB,GAAG,CAAC,QAAQ,CAAC;AAEb,QAAM,gBAAgB;AAAA,IACpB,CAAC,aAAqB;AACpB,4BAAsB;AAAA,QACpB,YAAY;AAAA,QACZ,YAAY;AAAA,UACV;AAAA,UACA;AAAA,QAAA;AAAA,MACF,CACD;AAAA,IACH;AAAA,IACA,CAAC,WAAW,qBAAqB;AAAA,EAAA;AAGnC,QAAM,eAAe,YAAY,MAAM;AAErC,0BAAsB;AAAA,MACpB,YAAY,SAAS,cAAc,OAAO,gBAAgB;AAAA,IAAA,CAC3D;AAAA,EACH,GAAG,CAAC,MAAM,qBAAqB,CAAC;AAEhC,QAAM,cAAc;AAAA,IAClB,CAAC,UAAoB;AACnB,4BAAsB;AAAA,QACpB,YAAY;AAAA,QACZ,YAAY;AAAA,MAAA,CACb;AAAA,IACH;AAAA,IACA,CAAC,qBAAqB;AAAA,EAAA;AAGxB,QAAM,QAAQ,QAAQ,MAAM;AAC1B,YAAQ,WAAA;AAAA,MACN,KAAK,UAAU;AACb,eACE;AAAA,UAAC;AAAA,UAAA;AAAA,YACC;AAAA,YACA,WAAW;AAAA,YACX,UAAU;AAAA,YACV,SAAS;AAAA,UAAA;AAAA,UAJX;AAAA,UAAA;AAAA,UAAA;AAAA,YAAA,UAAA;AAAA,YAAA,YAAA;AAAA,YAAA,cAAA;AAAA,UAAA;AAAA,UAAA;AAAA,QAAA;AAAA,MAOJ,KAAK,UAAU;AACb,eACE,uBAAC,OAAA,EAAI,WAAU,mBACb,UAAA;AAAA,UAAA,uBAAC,YAAS,OAAA,GAAV,QAAA,OAAA;AAAA,YAAA,UAAA;AAAA,YAAA,YAAA;AAAA,YAAA,cAAA;AAAA,UAAA,GAAA,IAA0B;AAAA,UAC1B,uBAAC,OAAA,EAAI,WAAU,oCACb,iCAAC,UAAA,CAAA,GAAD,QAAA,OAAA;AAAA,YAAA,UAAA;AAAA,YAAA,YAAA;AAAA,YAAA,cAAA;AAAA,UAAA,GAAA,IAAU,EAAA,GADZ,QAAA,OAAA;AAAA,YAAA,UAAA;AAAA,YAAA,YAAA;AAAA,YAAA,cAAA;AAAA,UAAA,GAAA,IAEA;AAAA,QAAA,EAAA,GAJF,QAAA,MAAA;AAAA,UAAA,UAAA;AAAA,UAAA,YAAA;AAAA,UAAA,cAAA;AAAA,QAAA,GAAA,IAKA;AAAA,MAEJ;AAEE,eACE;AAAA,UAAC;AAAA,UAAA;AAAA,YACC;AAAA,YACA,WAAW;AAAA,YACX,UAAU;AAAA,YACV,SAAS;AAAA,UAAA;AAAA,UAJX;AAAA,UAAA;AAAA,UAAA;AAAA,YAAA,UAAA;AAAA,YAAA,YAAA;AAAA,YAAA,cAAA;AAAA,UAAA;AAAA,UAAA;AAAA,QAAA;AAAA,IAKA;AAAA,EAGR,GAAG,CAAC,aAAa,cAAc,eAAe,WAAW,MAAM,CAAC;AAEhE,gCAAQ,OAAA,EAAI,WAAW,GAAG,QAAQ,SAAS,GAAI,UAAA,SAAxC,QAAA,OAAA;AAAA,IAAA,UAAA;AAAA,IAAA,YAAA;AAAA,IAAA,cAAA;AAAA,EAAA,GAAA,IAA8C;AACvD;"}