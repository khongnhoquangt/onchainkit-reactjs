{"version":3,"file":"CheckoutButton.js","sources":["../../../src/checkout/components/CheckoutButton.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useMemo } from 'react';\nimport { useAnalytics } from '../../core/analytics/hooks/useAnalytics';\nimport { CheckoutEvent } from '../../core/analytics/types';\nimport { Spinner } from '../../internal/components/Spinner';\nimport { useIcon } from '../../internal/hooks/useIcon';\nimport {\n  border,\n  cn,\n  color,\n  pressable,\n  text as styleText,\n} from '../../styles/theme';\nimport { CHECKOUT_LIFECYCLESTATUS } from '../constants';\nimport type { CheckoutButtonReact } from '../types';\nimport { useCheckoutContext } from './CheckoutProvider';\n\nexport function CheckoutButton({\n  className,\n  coinbaseBranded,\n  disabled,\n  icon,\n  text = 'Pay',\n}: CheckoutButtonReact) {\n  if (coinbaseBranded) {\n    icon = 'coinbasePay';\n    text = 'Pay';\n  }\n  const { lifecycleStatus, onSubmit } = useCheckoutContext();\n  const iconSvg = useIcon({ icon });\n  const { sendAnalytics } = useAnalytics();\n\n  const isLoading =\n    lifecycleStatus?.statusName === CHECKOUT_LIFECYCLESTATUS.PENDING;\n  const isFetchingData =\n    lifecycleStatus?.statusName === CHECKOUT_LIFECYCLESTATUS.FETCHING_DATA;\n  const isDisabled = disabled || isLoading || isFetchingData;\n  const buttonText = useMemo(() => {\n    if (lifecycleStatus?.statusName === CHECKOUT_LIFECYCLESTATUS.SUCCESS) {\n      return 'View payment details';\n    }\n    return text;\n  }, [lifecycleStatus?.statusName, text]);\n  const shouldRenderIcon = buttonText === text && iconSvg;\n\n  useEffect(() => {\n    if (\n      lifecycleStatus?.statusName === CHECKOUT_LIFECYCLESTATUS.SUCCESS &&\n      lifecycleStatus.statusData\n    ) {\n      const { transactionReceipts, chargeId } = lifecycleStatus.statusData;\n      const transactionHash = transactionReceipts?.[0]?.transactionHash;\n\n      if (transactionHash && chargeId) {\n        sendAnalytics(CheckoutEvent.CheckoutSuccess, {\n          chargeHandlerId: chargeId,\n          transactionHash,\n        });\n      }\n    }\n  }, [lifecycleStatus, sendAnalytics]);\n\n  return (\n    <button\n      className={cn(\n        coinbaseBranded ? pressable.coinbaseBranding : pressable.primary,\n        border.radius,\n        isDisabled && pressable.disabled,\n        styleText.headline,\n        'mt-4 w-full px-4 py-3',\n        className,\n      )}\n      onClick={onSubmit}\n      type=\"button\"\n      disabled={isDisabled}\n    >\n      <div className=\"flex items-center justify-center whitespace-nowrap\">\n        {isLoading ? (\n          <Spinner className=\"h-5 w-5\" />\n        ) : (\n          <>\n            {shouldRenderIcon && (\n              <div className=\"mr-2 flex h-5 w-5 shrink-0 items-center justify-center\">\n                {iconSvg}\n              </div>\n            )}\n            <span\n              className={cn(\n                styleText.headline,\n                coinbaseBranded ? 'text-gray-50' : color.inverse,\n              )}\n            >\n              {buttonText}\n            </span>\n          </>\n        )}\n      </div>\n    </button>\n  );\n}\n"],"names":["text","styleText"],"mappings":";;;;;;;;;AAkBO,SAAS,eAAe;AAAA,EAC7B;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAAA,MACAA,SAAO;AACT,GAAwB;AACtB,MAAI,iBAAiB;AACnB,WAAO;AACPA,aAAO;AAAA,EACT;AACA,QAAM,EAAE,iBAAiB,SAAA,IAAa,mBAAA;AACtC,QAAM,UAAU,QAAQ,EAAE,MAAM;AAChC,QAAM,EAAE,cAAA,IAAkB,aAAA;AAE1B,QAAM,aACJ,mDAAiB,gBAAe,yBAAyB;AAC3D,QAAM,kBACJ,mDAAiB,gBAAe,yBAAyB;AAC3D,QAAM,aAAa,YAAY,aAAa;AAC5C,QAAM,aAAa,QAAQ,MAAM;AAC/B,SAAI,mDAAiB,gBAAe,yBAAyB,SAAS;AACpE,aAAO;AAAA,IACT;AACA,WAAOA;AAAAA,EACT,GAAG,CAAC,mDAAiB,YAAYA,MAAI,CAAC;AACtC,QAAM,mBAAmB,eAAeA,UAAQ;AAEhD,YAAU,MAAM;;AACd,SACE,mDAAiB,gBAAe,yBAAyB,WACzD,gBAAgB,YAChB;AACA,YAAM,EAAE,qBAAqB,SAAA,IAAa,gBAAgB;AAC1D,YAAM,mBAAkB,gEAAsB,OAAtB,mBAA0B;AAElD,UAAI,mBAAmB,UAAU;AAC/B,sBAAc,cAAc,iBAAiB;AAAA,UAC3C,iBAAiB;AAAA,UACjB;AAAA,QAAA,CACD;AAAA,MACH;AAAA,IACF;AAAA,EACF,GAAG,CAAC,iBAAiB,aAAa,CAAC;AAEnC,SACE;AAAA,IAAC;AAAA,IAAA;AAAA,MACC,WAAW;AAAA,QACT,kBAAkB,UAAU,mBAAmB,UAAU;AAAA,QACzD,OAAO;AAAA,QACP,cAAc,UAAU;AAAA,QACxBC,KAAU;AAAA,QACV;AAAA,QACA;AAAA,MAAA;AAAA,MAEF,SAAS;AAAA,MACT,MAAK;AAAA,MACL,UAAU;AAAA,MAEV,UAAA,uBAAC,SAAI,WAAU,sDACZ,sBACC,uBAAC,SAAA,EAAQ,WAAU,UAAA,GAAnB,QAAA,OAAA;AAAA,QAAA,UAAA;AAAA,QAAA,YAAA;AAAA,QAAA,cAAA;AAAA,MAAA,GAAA,IAA6B,IAE7B,uBAAA,UAAA,EACG,UAAA;AAAA,QAAA,oBACC,uBAAC,OAAA,EAAI,WAAU,0DACZ,UAAA,QAAA,GADH,QAAA,OAAA;AAAA,UAAA,UAAA;AAAA,UAAA,YAAA;AAAA,UAAA,cAAA;AAAA,QAAA,GAAA,IAEA;AAAA,QAEF;AAAA,UAAC;AAAA,UAAA;AAAA,YACC,WAAW;AAAA,cACTA,KAAU;AAAA,cACV,kBAAkB,iBAAiB,MAAM;AAAA,YAAA;AAAA,YAG1C,UAAA;AAAA,UAAA;AAAA,UANH;AAAA,UAAA;AAAA,UAAA;AAAA,YAAA,UAAA;AAAA,YAAA,YAAA;AAAA,YAAA,cAAA;AAAA,UAAA;AAAA,UAAA;AAAA,QAAA;AAAA,MAOA,EAAA,GAbF,QAAA,MAAA;AAAA,QAAA,UAAA;AAAA,QAAA,YAAA;AAAA,QAAA,cAAA;AAAA,MAAA,GAAA,IAcA,EAAA,GAlBJ,QAAA,OAAA;AAAA,QAAA,UAAA;AAAA,QAAA,YAAA;AAAA,QAAA,cAAA;AAAA,MAAA,GAAA,IAoBA;AAAA,IAAA;AAAA,IAjCF;AAAA,IAAA;AAAA,IAAA;AAAA,MAAA,UAAA;AAAA,MAAA,YAAA;AAAA,MAAA,cAAA;AAAA,IAAA;AAAA,IAAA;AAAA,EAAA;AAoCJ;"}