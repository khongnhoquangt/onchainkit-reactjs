{"version":3,"file":"WalletProvider.js","sources":["../../../src/wallet/components/WalletProvider.tsx"],"sourcesContent":["'use client';\n\nimport { useBreakpoints } from '@/internal/hooks/useBreakpoints';\nimport { useOnchainKit } from '@/useOnchainKit';\nimport {\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport type { ReactNode } from 'react';\nimport { useAccount } from 'wagmi';\nimport type { WalletAdvancedFeature, WalletContextType } from '../types';\nimport { getAnimations } from '../utils/getAnimations';\nimport { calculateSubComponentPosition } from '../utils/getWalletSubComponentPosition';\n\nconst emptyContext = {} as WalletContextType;\n\nconst WalletContext = createContext<WalletContextType>(emptyContext);\n\nexport type WalletProviderReact = {\n  children: ReactNode;\n  /** Whether to sponsor transactions for Send feature of advanced wallet implementation */\n  isSponsored?: boolean;\n};\n\nexport function WalletProvider({ children, isSponsored }: WalletProviderReact) {\n  const { chain } = useOnchainKit();\n  const [isConnectModalOpen, setIsConnectModalOpen] = useState(false);\n  const [isSubComponentOpen, setIsSubComponentOpen] = useState(false);\n  const [isSubComponentClosing, setIsSubComponentClosing] = useState(false);\n  const [showSubComponentAbove, setShowSubComponentAbove] = useState(false);\n  const [alignSubComponentRight, setAlignSubComponentRight] = useState(false);\n\n  const connectRef = useRef<HTMLDivElement>(null);\n  const { address } = useAccount();\n  const breakpoint = useBreakpoints();\n\n  const [activeFeature, setActiveFeature] =\n    useState<WalletAdvancedFeature | null>(null);\n  const [isActiveFeatureClosing, setIsActiveFeatureClosing] = useState(false);\n\n  const animations = useMemo(() => {\n    return getAnimations(isSubComponentClosing, showSubComponentAbove);\n  }, [isSubComponentClosing, showSubComponentAbove]);\n\n  const handleClose = useCallback(() => {\n    if (!isSubComponentOpen) {\n      return;\n    }\n    setIsSubComponentClosing(true);\n  }, [isSubComponentOpen]);\n\n  useEffect(() => {\n    if (isSubComponentOpen && connectRef?.current) {\n      const connectRect = connectRef.current.getBoundingClientRect();\n      const position = calculateSubComponentPosition(connectRect);\n      setShowSubComponentAbove(position.showAbove);\n      setAlignSubComponentRight(position.alignRight);\n    }\n  }, [isSubComponentOpen]);\n\n  const value = useMemo(() => {\n    return {\n      address,\n      chain,\n      breakpoint,\n      isConnectModalOpen,\n      setIsConnectModalOpen,\n      isSubComponentOpen,\n      setIsSubComponentOpen,\n      isSubComponentClosing,\n      setIsSubComponentClosing,\n      handleClose,\n      connectRef,\n      showSubComponentAbove,\n      alignSubComponentRight,\n      activeFeature,\n      setActiveFeature,\n      isActiveFeatureClosing,\n      setIsActiveFeatureClosing,\n      animations,\n      isSponsored,\n    };\n  }, [\n    address,\n    chain,\n    breakpoint,\n    isConnectModalOpen,\n    isSubComponentOpen,\n    isSubComponentClosing,\n    handleClose,\n    showSubComponentAbove,\n    alignSubComponentRight,\n    activeFeature,\n    isActiveFeatureClosing,\n    animations,\n    isSponsored,\n  ]);\n\n  return (\n    <WalletContext.Provider value={value}>{children}</WalletContext.Provider>\n  );\n}\n\nexport function useWalletContext() {\n  return useContext(WalletContext);\n}\n"],"names":[],"mappings":";;;;;;;AAmBA,MAAM,eAAe,CAAA;AAErB,MAAM,gBAAgB,cAAiC,YAAY;AAQ5D,SAAS,eAAe,EAAE,UAAU,eAAoC;AAC7E,QAAM,EAAE,MAAA,IAAU,cAAA;AAClB,QAAM,CAAC,oBAAoB,qBAAqB,IAAI,SAAS,KAAK;AAClE,QAAM,CAAC,oBAAoB,qBAAqB,IAAI,SAAS,KAAK;AAClE,QAAM,CAAC,uBAAuB,wBAAwB,IAAI,SAAS,KAAK;AACxE,QAAM,CAAC,uBAAuB,wBAAwB,IAAI,SAAS,KAAK;AACxE,QAAM,CAAC,wBAAwB,yBAAyB,IAAI,SAAS,KAAK;AAE1E,QAAM,aAAa,OAAuB,IAAI;AAC9C,QAAM,EAAE,QAAA,IAAY,WAAA;AACpB,QAAM,aAAa,eAAA;AAEnB,QAAM,CAAC,eAAe,gBAAgB,IACpC,SAAuC,IAAI;AAC7C,QAAM,CAAC,wBAAwB,yBAAyB,IAAI,SAAS,KAAK;AAE1E,QAAM,aAAa,QAAQ,MAAM;AAC/B,WAAO,cAAc,uBAAuB,qBAAqB;AAAA,EACnE,GAAG,CAAC,uBAAuB,qBAAqB,CAAC;AAEjD,QAAM,cAAc,YAAY,MAAM;AACpC,QAAI,CAAC,oBAAoB;AACvB;AAAA,IACF;AACA,6BAAyB,IAAI;AAAA,EAC/B,GAAG,CAAC,kBAAkB,CAAC;AAEvB,YAAU,MAAM;AACd,QAAI,uBAAsB,yCAAY,UAAS;AAC7C,YAAM,cAAc,WAAW,QAAQ,sBAAA;AACvC,YAAM,WAAW,8BAA8B,WAAW;AAC1D,+BAAyB,SAAS,SAAS;AAC3C,gCAA0B,SAAS,UAAU;AAAA,IAC/C;AAAA,EACF,GAAG,CAAC,kBAAkB,CAAC;AAEvB,QAAM,QAAQ,QAAQ,MAAM;AAC1B,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IAAA;AAAA,EAEJ,GAAG;AAAA,IACD;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA,CACD;AAED,SACE,uBAAC,cAAc,UAAd,EAAuB,OAAe,SAAA,GAAvC,QAAA,OAAA;AAAA,IAAA,UAAA;AAAA,IAAA,YAAA;AAAA,IAAA,cAAA;AAAA,EAAA,GAAA,IAAgD;AAEpD;AAEO,SAAS,mBAAmB;AACjC,SAAO,WAAW,aAAa;AACjC;"}