{"version":3,"file":"useRecipientState.js","sources":["../../../../../src/wallet/components/wallet-advanced-send/hooks/useRecipientState.tsx"],"sourcesContent":["import { getName } from '@/identity';\nimport { getSlicedAddress } from '@/identity/utils/getSlicedAddress';\nimport { useState, useEffect, useCallback } from 'react';\nimport { base } from 'viem/chains';\nimport { RecipientState } from '../types';\nimport { validateAddressInput } from '../utils/validateAddressInput';\n\nexport function useRecipientState() {\n  const [recipientState, setRecipientState] = useState<RecipientState>({\n    phase: 'input',\n    input: '',\n    address: null,\n    displayValue: null,\n  });\n\n  const updateRecipientInput = useCallback((input: string) => {\n    setRecipientState((prev) => ({\n      ...prev,\n      input,\n    }));\n  }, []);\n\n  const validateRecipientInput = useCallback((input: string) => {\n    validateAddressInput(input).then((validatedAddress) => {\n      if (!validatedAddress) {\n        setRecipientState({\n          phase: 'input',\n          input,\n          address: null,\n          displayValue: null,\n        });\n        return;\n      }\n\n      setRecipientState({\n        phase: 'validated',\n        input,\n        address: validatedAddress,\n        displayValue: null,\n      });\n    });\n  }, []);\n\n  const selectRecipient = useCallback(\n    async (selection: Extract<RecipientState, { phase: 'selected' }>) => {\n      setRecipientState(selection);\n    },\n    [],\n  );\n\n  const deselectRecipient = useCallback(() => {\n    if (recipientState.phase === 'selected') {\n      setRecipientState({\n        phase: 'validated',\n        input: recipientState.input,\n        address: recipientState.address,\n        displayValue: null,\n      });\n    } else {\n      setRecipientState({\n        ...recipientState,\n        displayValue: null,\n      });\n    }\n  }, [recipientState]);\n\n  useEffect(() => {\n    if (recipientState.phase === 'selected') {\n      getName({\n        address: recipientState.address,\n        chain: base,\n      })\n        .then((name) => {\n          setRecipientState({\n            phase: recipientState.phase,\n            input: recipientState.input,\n            address: recipientState.address,\n            displayValue: name ?? getSlicedAddress(recipientState.address),\n          });\n        })\n        .catch(() =>\n          setRecipientState({\n            phase: recipientState.phase,\n            input: recipientState.input,\n            address: recipientState.address,\n            displayValue: getSlicedAddress(recipientState.address),\n          }),\n        );\n    }\n  }, [recipientState.phase, recipientState.address, recipientState.input]);\n\n  return {\n    recipientState,\n    updateRecipientInput,\n    validateRecipientInput,\n    selectRecipient,\n    deselectRecipient,\n  };\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAOO,SAAS,oBAAoB;AAClC,QAAM,CAAC,gBAAgB,iBAAiB,IAAI,SAAyB;AAAA,IACnE,OAAO;AAAA,IACP,OAAO;AAAA,IACP,SAAS;AAAA,IACT,cAAc;AAAA,EAAA,CACf;AAED,QAAM,uBAAuB,YAAY,CAAC,UAAkB;AAC1D,sBAAkB,CAAC,UAAU;AAAA,MAC3B,GAAG;AAAA,MACH;AAAA,IAAA,EACA;AAAA,EACJ,GAAG,CAAA,CAAE;AAEL,QAAM,yBAAyB,YAAY,CAAC,UAAkB;AAC5D,yBAAqB,KAAK,EAAE,KAAK,CAAC,qBAAqB;AACrD,UAAI,CAAC,kBAAkB;AACrB,0BAAkB;AAAA,UAChB,OAAO;AAAA,UACP;AAAA,UACA,SAAS;AAAA,UACT,cAAc;AAAA,QAAA,CACf;AACD;AAAA,MACF;AAEA,wBAAkB;AAAA,QAChB,OAAO;AAAA,QACP;AAAA,QACA,SAAS;AAAA,QACT,cAAc;AAAA,MAAA,CACf;AAAA,IACH,CAAC;AAAA,EACH,GAAG,CAAA,CAAE;AAEL,QAAM,kBAAkB;AAAA,IACtB,OAAO,cAA8D;AACnE,wBAAkB,SAAS;AAAA,IAC7B;AAAA,IACA,CAAA;AAAA,EAAC;AAGH,QAAM,oBAAoB,YAAY,MAAM;AAC1C,QAAI,eAAe,UAAU,YAAY;AACvC,wBAAkB;AAAA,QAChB,OAAO;AAAA,QACP,OAAO,eAAe;AAAA,QACtB,SAAS,eAAe;AAAA,QACxB,cAAc;AAAA,MAAA,CACf;AAAA,IACH,OAAO;AACL,wBAAkB;AAAA,QAChB,GAAG;AAAA,QACH,cAAc;AAAA,MAAA,CACf;AAAA,IACH;AAAA,EACF,GAAG,CAAC,cAAc,CAAC;AAEnB,YAAU,MAAM;AACd,QAAI,eAAe,UAAU,YAAY;AACvC,cAAQ;AAAA,QACN,SAAS,eAAe;AAAA,QACxB,OAAO;AAAA,MAAA,CACR,EACE,KAAK,CAAC,SAAS;AACd,0BAAkB;AAAA,UAChB,OAAO,eAAe;AAAA,UACtB,OAAO,eAAe;AAAA,UACtB,SAAS,eAAe;AAAA,UACxB,cAAc,QAAQ,iBAAiB,eAAe,OAAO;AAAA,QAAA,CAC9D;AAAA,MACH,CAAC,EACA;AAAA,QAAM,MACL,kBAAkB;AAAA,UAChB,OAAO,eAAe;AAAA,UACtB,OAAO,eAAe;AAAA,UACtB,SAAS,eAAe;AAAA,UACxB,cAAc,iBAAiB,eAAe,OAAO;AAAA,QAAA,CACtD;AAAA,MAAA;AAAA,IAEP;AAAA,EACF,GAAG,CAAC,eAAe,OAAO,eAAe,SAAS,eAAe,KAAK,CAAC;AAEvE,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ;"}