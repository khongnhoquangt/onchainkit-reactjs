{"version":3,"file":"DismissableLayer.js","sources":["../../../src/internal/components/DismissableLayer.tsx"],"sourcesContent":["import type React from 'react';\nimport { useEffect, useRef } from 'react';\n\ntype DismissableLayerProps = {\n  children?: React.ReactNode;\n  disableEscapeKey?: boolean;\n  disableOutsideClick?: boolean;\n  onDismiss?: () => void;\n  /**\n   * Reference to the trigger element (e.g., button) that opens this layer.\n   * Prevents the layer from being dismissed when the trigger is clicked, enabling proper toggle behavior.\n   */\n  triggerRef?: React.RefObject<HTMLElement>;\n  /**\n   * When `true`, prevents trigger click events from bubbling up.\n   * Useful for bottom sheets to prevent unwanted side effects.\n   */\n  preventTriggerEvents?: boolean;\n};\n\n/**\n * DismissableLayer handles dismissal using outside clicks and escape key events\n */\nexport function DismissableLayer({\n  children,\n  disableEscapeKey = false,\n  disableOutsideClick = false,\n  onDismiss,\n  triggerRef,\n  preventTriggerEvents = false,\n}: DismissableLayerProps) {\n  const layerRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    if (disableOutsideClick && disableEscapeKey) {\n      return;\n    }\n\n    const handleTriggerClick = (event: PointerEvent) => {\n      if (preventTriggerEvents) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    };\n\n    const isClickInsideLayer = (target: Node) => {\n      return layerRef.current?.contains(target);\n    };\n\n    const handlePointerDownCapture = (event: PointerEvent) => {\n      if (disableOutsideClick) {\n        return;\n      }\n\n      if (!(event.target instanceof Node)) {\n        return;\n      }\n\n      const target = event.target;\n\n      if (triggerRef?.current?.contains(target)) {\n        handleTriggerClick(event);\n        return;\n      }\n\n      if (!isClickInsideLayer(target)) {\n        onDismiss?.();\n      }\n    };\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (!disableEscapeKey && event.key === 'Escape') {\n        onDismiss?.();\n      }\n    };\n\n    document.addEventListener('pointerdown', handlePointerDownCapture, true);\n    document.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      document.removeEventListener(\n        'pointerdown',\n        handlePointerDownCapture,\n        true,\n      );\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [\n    disableOutsideClick,\n    disableEscapeKey,\n    onDismiss,\n    triggerRef,\n    preventTriggerEvents,\n  ]);\n\n  return (\n    <div data-testid=\"ockDismissableLayer\" ref={layerRef}>\n      {children}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;AAuBO,SAAS,iBAAiB;AAAA,EAC/B;AAAA,EACA,mBAAmB;AAAA,EACnB,sBAAsB;AAAA,EACtB;AAAA,EACA;AAAA,EACA,uBAAuB;AACzB,GAA0B;AACxB,QAAM,WAAW,OAAuB,IAAI;AAE5C,YAAU,MAAM;AACd,QAAI,uBAAuB,kBAAkB;AAC3C;AAAA,IACF;AAEA,UAAM,qBAAqB,CAAC,UAAwB;AAClD,UAAI,sBAAsB;AACxB,cAAM,eAAA;AACN,cAAM,gBAAA;AAAA,MACR;AAAA,IACF;AAEA,UAAM,qBAAqB,CAAC,WAAiB;;AAC3C,cAAO,cAAS,YAAT,mBAAkB,SAAS;AAAA,IACpC;AAEA,UAAM,2BAA2B,CAAC,UAAwB;;AACxD,UAAI,qBAAqB;AACvB;AAAA,MACF;AAEA,UAAI,EAAE,MAAM,kBAAkB,OAAO;AACnC;AAAA,MACF;AAEA,YAAM,SAAS,MAAM;AAErB,WAAI,8CAAY,YAAZ,mBAAqB,SAAS,SAAS;AACzC,2BAAmB,KAAK;AACxB;AAAA,MACF;AAEA,UAAI,CAAC,mBAAmB,MAAM,GAAG;AAC/B;AAAA,MACF;AAAA,IACF;AAEA,UAAM,gBAAgB,CAAC,UAAyB;AAC9C,UAAI,CAAC,oBAAoB,MAAM,QAAQ,UAAU;AAC/C;AAAA,MACF;AAAA,IACF;AAEA,aAAS,iBAAiB,eAAe,0BAA0B,IAAI;AACvE,aAAS,iBAAiB,WAAW,aAAa;AAElD,WAAO,MAAM;AACX,eAAS;AAAA,QACP;AAAA,QACA;AAAA,QACA;AAAA,MAAA;AAEF,eAAS,oBAAoB,WAAW,aAAa;AAAA,IACvD;AAAA,EACF,GAAG;AAAA,IACD;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA,CACD;AAED,gCACG,OAAA,EAAI,eAAY,uBAAsB,KAAK,UACzC,SAAA,GADH,QAAA,OAAA;AAAA,IAAA,UAAA;AAAA,IAAA,YAAA;AAAA,IAAA,cAAA;AAAA,EAAA,GAAA,IAEA;AAEJ;"}