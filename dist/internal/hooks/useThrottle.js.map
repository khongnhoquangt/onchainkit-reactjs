{"version":3,"file":"useThrottle.js","sources":["../../../src/internal/hooks/useThrottle.ts"],"sourcesContent":["import { useCallback, useEffect, useRef } from 'react';\n\ntype AnyFunction = (...args: unknown[]) => unknown;\n\n/**\n * A hook that returns a throttled version of a callback function.\n * Throttling ensures the callback is executed at most once within the specified delay period.\n *\n * @param callback - The function to throttle\n * @param delay - The number of milliseconds to wait before allowing another execution\n *\n * @returns A throttled version of the callback that maintains the same arguments\n * and automatically cleans up any pending executions on unmount\n *\n * More details on throttle: https://developer.mozilla.org/en-US/docs/Glossary/Throttle\n */\nexport const useThrottle = <T extends AnyFunction>(\n  callback: T,\n  delay: number,\n): ((...args: Parameters<T>) => void) => {\n  const lastCallTime = useRef<number>(0);\n  const timeoutRef = useRef<NodeJS.Timeout>();\n  const lastArgsRef = useRef<Parameters<T>>();\n  const callbackRef = useRef(callback);\n  callbackRef.current = callback;\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n    };\n  }, []);\n\n  return useCallback(\n    (...args: Parameters<T>) => {\n      const now = Date.now();\n      const timeSinceLastCall = now - lastCallTime.current;\n\n      if (timeSinceLastCall >= delay) {\n        // Execute immediately if enough time has passed\n        callbackRef.current(...args);\n        lastCallTime.current = now;\n      } else if (timeoutRef.current) {\n        // Update the scheduled execution with the latest arguments\n        lastArgsRef.current = args;\n      } else if (!timeoutRef.current) {\n        // Store args for delayed execution\n        lastArgsRef.current = args;\n        // Schedule next execution at the end of delay period\n        timeoutRef.current = setTimeout(() => {\n          if (lastArgsRef.current) {\n            callbackRef.current(...lastArgsRef.current);\n            lastCallTime.current = Date.now();\n          }\n          timeoutRef.current = undefined;\n        }, delay - timeSinceLastCall);\n      }\n    },\n    [delay],\n  );\n};\n"],"names":[],"mappings":";AAgBO,MAAM,cAAc,CACzB,UACA,UACuC;AACvC,QAAM,eAAe,OAAe,CAAC;AACrC,QAAM,aAAa,OAAA;AACnB,QAAM,cAAc,OAAA;AACpB,QAAM,cAAc,OAAO,QAAQ;AACnC,cAAY,UAAU;AAGtB,YAAU,MAAM;AACd,WAAO,MAAM;AACX,UAAI,WAAW,SAAS;AACtB,qBAAa,WAAW,OAAO;AAAA,MACjC;AAAA,IACF;AAAA,EACF,GAAG,CAAA,CAAE;AAEL,SAAO;AAAA,IACL,IAAI,SAAwB;AAC1B,YAAM,MAAM,KAAK,IAAA;AACjB,YAAM,oBAAoB,MAAM,aAAa;AAE7C,UAAI,qBAAqB,OAAO;AAE9B,oBAAY,QAAQ,GAAG,IAAI;AAC3B,qBAAa,UAAU;AAAA,MACzB,WAAW,WAAW,SAAS;AAE7B,oBAAY,UAAU;AAAA,MACxB,WAAW,CAAC,WAAW,SAAS;AAE9B,oBAAY,UAAU;AAEtB,mBAAW,UAAU,WAAW,MAAM;AACpC,cAAI,YAAY,SAAS;AACvB,wBAAY,QAAQ,GAAG,YAAY,OAAO;AAC1C,yBAAa,UAAU,KAAK,IAAA;AAAA,UAC9B;AACA,qBAAW,UAAU;AAAA,QACvB,GAAG,QAAQ,iBAAiB;AAAA,MAC9B;AAAA,IACF;AAAA,IACA,CAAC,KAAK;AAAA,EAAA;AAEV;"}