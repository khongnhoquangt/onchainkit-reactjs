{"version":3,"file":"TokenSelectModal.js","sources":["../../../src/token/components/TokenSelectModal.tsx"],"sourcesContent":["'use client';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport { background, cn, text } from '../../styles/theme';\nimport type { Token, TokenSelectModalReact } from '../types';\nimport { TokenChip } from './TokenChip';\nimport { TokenRow } from './TokenRow';\nimport { TokenSearch } from './TokenSearch';\nimport { TokenSelectButton } from './TokenSelectButton';\n\nconst backdropStyle = {\n  background: 'rgba(226, 232, 240, 0.5)',\n};\n\ntype TokenSelectModalInnerReact = {\n  setToken: (t: Token) => void;\n  closeModal: () => void;\n  options: Token[];\n};\n\nfunction TokenSelectModalInner({\n  setToken,\n  closeModal,\n  options,\n}: TokenSelectModalInnerReact) {\n  const [filteredTokens, setFilteredTokens] = useState(options);\n  const modalRef = useRef<HTMLDivElement>(null);\n\n  const handleClick = useCallback(\n    (token: Token) => {\n      setToken(token);\n      closeModal();\n    },\n    [setToken, closeModal],\n  );\n\n  const handleChange = useCallback(\n    (text: string) => {\n      setFilteredTokens(\n        options.filter(({ address, name, symbol }) => {\n          return (\n            address.toLowerCase().startsWith(text) ||\n            name.toLowerCase().includes(text) ||\n            symbol.toLowerCase().includes(text)\n          );\n        }),\n      );\n    },\n    [options],\n  );\n\n  /* v8 ignore next 10 */\n  const handleBlur = useCallback(\n    (event: MouseEvent) => {\n      const isOutsideModal =\n        modalRef.current && !modalRef.current.contains(event.target as Node);\n      if (isOutsideModal) {\n        closeModal();\n      }\n    },\n    [closeModal],\n  );\n\n  useEffect(() => {\n    // NOTE: this ensures that handleBlur doesn't get called on initial mount\n    //       We need to use non-div elements to properly handle onblur events\n    setTimeout(() => {\n      document.addEventListener('click', handleBlur);\n    }, 0);\n    return () => {\n      document.removeEventListener('click', handleBlur);\n    };\n  }, [handleBlur]);\n\n  return (\n    <div\n      data-testid=\"ockTokenSelectModal_Inner\"\n      className=\"fixed top-0 left-0 z-50 flex h-full w-full items-center justify-center\"\n      style={backdropStyle}\n    >\n      <div\n        ref={modalRef}\n        className={cn(\n          background.default,\n          'flex w-[475px] flex-col gap-3 rounded-3xl p-6',\n        )}\n      >\n        <div className=\"flex items-center justify-between\">\n          <span className={text.title3}>Select a token</span>\n          <button\n            data-testid=\"TokenSelectModal_CloseButton\"\n            type=\"button\"\n            onClick={closeModal}\n          >\n            <svg\n              role=\"img\"\n              aria-label=\"ock-close-icon\"\n              width=\"16\"\n              height=\"16\"\n              viewBox=\"0 0 16 16\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            >\n              <path\n                d=\"M2.3352 1L1 2.33521L6.66479 8L1 13.6648L2.3352 15L8 9.33521L13.6648 15L15 13.6648L9.33521 8L15 2.33521L13.6648 1L8 6.6648L2.3352 1Z\"\n                fill=\"#0A0B0D\"\n              />\n            </svg>\n          </button>\n        </div>\n        <TokenSearch onChange={handleChange} delayMs={0} />\n        {filteredTokens.length > 0 && (\n          <div className=\"flex flex-wrap gap-2\">\n            {filteredTokens.slice(0, 4).map((token, idx) => (\n              <TokenChip\n                key={`${token.name}${idx}`}\n                className=\"shadow-none\"\n                token={token}\n                onClick={handleClick}\n              />\n            ))}\n          </div>\n        )}\n        {filteredTokens.length > 0 ? (\n          <div className=\"mt-3\">\n            <div className=\"text-black text-body\">Tokens</div>\n            <div\n              className=\"ock-scrollbar overflow-y-auto\"\n              style={{ minHeight: '300px', height: '300px' }}\n            >\n              {filteredTokens.map((token, idx) => (\n                <TokenRow\n                  key={`${token.name}${idx}`}\n                  token={token}\n                  onClick={handleClick}\n                />\n              ))}\n            </div>\n          </div>\n        ) : (\n          <div\n            data-testid=\"ockTokenSelectModal_NoTokens\"\n            className=\"text-black text-body\"\n            style={{ minHeight: '368px' }}\n          >\n            No tokens found\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport function TokenSelectModal({\n  options,\n  setToken,\n  token,\n}: TokenSelectModalReact) {\n  const [isOpen, setIsOpen] = useState(false);\n\n  const closeModal = useCallback(() => {\n    setIsOpen(false);\n  }, []);\n\n  const openModal = useCallback(() => {\n    setIsOpen(true);\n  }, []);\n\n  return (\n    <>\n      <TokenSelectButton onClick={openModal} isOpen={isOpen} token={token} />\n      {isOpen && (\n        <TokenSelectModalInner\n          options={options}\n          setToken={setToken}\n          closeModal={closeModal}\n        />\n      )}\n    </>\n  );\n}\n"],"names":["text"],"mappings":"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"}