{"version":3,"file":"FileTransport.cjs","sources":["../../src/transports/FileTransport.ts"],"sourcesContent":null,"names":["FileTransport","Transport","constructor","options","path","stream","buffer","draining","lastSize","rotating","Path","resolve","checkFolderRequirements","blueprint","schemas","bool","number","gzip","maxSize","MAX_LOG_SIZE","positive","portablePathSchema","required","close","commit","onClose","undefined","once","end","open","createStream","exists","fs","statSync","size","message","write","written","Buffer","byteLength","checkIfNeedsRotation","mkdirSync","parent","recursive","closeStreamAndRotateFile","createWriteStream","encoding","flags","zlib","createGzip","pipe","getRotatedFileName","name","getNextIncrementCount","files","readdirSync","pattern","RegExp","count","forEach","file","match","rotateFile","fileName","renameSync","append"],"mappings":"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"}